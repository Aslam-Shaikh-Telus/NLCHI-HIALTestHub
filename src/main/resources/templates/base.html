<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>HIALTestHub | Base page</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
	<nav class="navbar navbar-expand-lg navbar-dark bg-secondary sticky-top" th:fragment="navbar">
		<div class="container-fluid text-white">
			<a class="navbar-brand" href="/home">HIALTestHub</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse"
				data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					<li class="nav-item">
						<a class="nav-link" href="/sanity">Sanity Test</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="/loadtest">Load Test</a>
					</li>
				</ul>
				<form class="d-flex flex-row">
					<span class="navbar-text p-2 flex-grow-1" id="usernameEndpoint">username@endpointIP</span>
					<a class="p-2 btn btn-sm btn-outline-danger" type="reset" th:href="@{/logout}">Log Out</a>
				</form>

			</div>
		</div>
	</nav>

	<script>

		// Function to update the username@endpointIP in the navbar
		function updateUsernameEndpoint() {
			$.ajax({
				url: '/api/endpoint/get',
				method: 'GET',
				dataType: 'json',
				success: function (endpoints) {
					// Assuming there is only one endpoint for the user
					if (endpoints.length > 0) {
						var endpoint = endpoints[0];
						var usernameEndpoint = endpoint.username + '@' + endpoint.ipAddress;
						$('#usernameEndpoint').text(usernameEndpoint);
					}
				},
				error: function () {
					console.error('Error retrieving endpoint data.');
				}
			});
		}

		// Call the function to update the username@endpointIP initially
		updateUsernameEndpoint();


	</script>
</body>

</html>